<html>
<head>
	<title>忍法列表</title>
	<link rel="stylesheet" href="./css/global.css">
	<link rel="stylesheet" href="./css/ninpo-card.css">
	<script src="./js/jquery-3.6.0.min.js"></script>
	<script src="./js/authenticator.js"></script>
	<script src="./js/myFilter.js"></script>
	<script src="./js/myFilterOptionBuilder.js"></script>
	<script src="./data/ninpo-list.js"></script>
	<script src="./js/ninpo-filter.js"></script>
	<script src="./js/ninpo-parser.js"></script>
	<script>
		var NINPO_LIST;  //from "data/ninpo-list.js"
		var NinpoFilter; //from "js/ninpo-filter.js"
		var NinpoOptionBuilder;

		NinpoFilter.SetList(NINPO_LIST);

		function searchText(){
			var text = $("#searchInput").val();
			NinpoFilter.SetConfigEntry('text', text);
			printResult();
		}

		function buildFilterOptionsList(){
			NinpoOptionBuilder.Build(".AdvancedFilterBar")
		}
		function toggleAdvancedFilterArea(){
			$(".AdvancedFilterBar").toggle(200)
		}
		function toggleDisplayMode(){
			printResult();
		}

		function printResult(){
			var isListMode = document.getElementById("displayMode").checked;
			var mode = (isListMode)? 'list': 'card';

			var container = $('.container');
			container.empty();
			for(var ninpoObj of NinpoFilter.Execute()){
				container.append(parseNinpo(ninpoObj, mode))
			}
		}

		window.onload = function(){
			buildFilterOptionsList();
			printResult()
		}
		window.addEventListener('selectFilterOption', function(e){
			NinpoFilter.toggleOption(e.detail.type, e.detail.value);
			printResult()
		});
	</script>
</head>
<body>
	<h1>忍法列表</h1>
	<div class="SearchPanel">
		<div class="SearchBar Bar">
			<button id="AdvancedSeatchBtn" onclick="toggleAdvancedFilterArea()">▼ 進階搜尋</button>
			<form class="SearchBox" onsubmit="event.preventDefault(); searchText()" role="search">
				<input id="searchInput" type="search" placeholder="尋找忍法名或效果..." autofocus />
				<button id="SearchBtn" type="submit">尋找</button>
			</form>
			<div class="SwitchBlock">
				<span class="label">啟用簡表檢視</span>
				<label class="switch">
					<input id="displayMode" type="checkbox" onChange="toggleDisplayMode()">
					<span class="slider"></span>
				</label>
			</div>
		</div>
		<div class="AdvancedFilterBar"></div>
	</div>
	<hr>

	<div class="container"></div>




</body>
</html>